<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸ¦Œ Rentier-Rennen</title>

<style>
html, body {
  margin: 0;
  padding: 0;
  height: 100%;
  overflow: hidden;
  font-family: system-ui, -apple-system, sans-serif;
  background: radial-gradient(circle at top, #1b4d3e, #061a14);
  color: white;
}

canvas {
  position: fixed;
  inset: 0;
}

/* HUD */
.hud {
  position: fixed;
  top: 20px;
  left: 50%;
  transform: translateX(-50%);
  padding: 0.8rem 1.6rem;
  border-radius: 30px;
  background: rgba(255,255,255,0.15);
  backdrop-filter: blur(10px);
  z-index: 10;
  font-size: 1.2rem;
  display: none;
}

/* Schnee */
.snow {
  position: fixed;
  inset: 0;
  pointer-events: none;
  background-image:
    radial-gradient(white 1px, transparent 1px),
    radial-gradient(white 1px, transparent 1px);
  background-size: 40px 40px, 80px 80px;
  animation: snow 30s linear infinite;
  z-index: 2;
}

@keyframes snow {
  from { background-position: 0 0, 0 0; }
  to   { background-position: 0 2000px, 0 3000px; }
}

/* Overlay (Start & Game Over) */
.overlay {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.65);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 20;
}

.card {
  background: rgba(255,255,255,0.18);
  backdrop-filter: blur(12px);
  padding: 2rem 3rem;
  border-radius: 30px;
  text-align: center;
  width: min(90%, 380px);
}

.card h1 {
  margin-top: 0;
}

button {
  margin-top: 1.5rem;
  padding: 0.8rem 1.8rem;
  border-radius: 25px;
  border: none;
  font-size: 1rem;
  cursor: pointer;
}

input[type="range"] {
  width: 100%;
}
</style>
</head>

<body>

<div class="hud">ğŸ„ Punkte: <span id="score">0</span></div>
<div class="snow"></div>
<canvas id="game"></canvas>

<!-- STARTSCREEN -->
<div id="startScreen" class="overlay">
  <div class="card">
    <h1>ğŸ¦Œ Rentier-Rennen</h1>
    <p>Schwierigkeit wÃ¤hlen</p>

    <input type="range" min="1" max="3" value="2" id="difficulty">
    <p id="diffLabel">ğŸŸ¡ Mittel</p>

    <button onclick="startGame()">â–¶ï¸ Start</button>
  </div>
</div>

<!-- GAME OVER -->
<div id="gameOver" class="overlay" style="display:none">
  <div class="card">
    <h2>ğŸ… Game Over</h2>
    <p>Score: <span id="finalScore"></span></p>
    <button onclick="location.reload()">Nochmal</button>
  </div>
</div>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
canvas.width = innerWidth;
canvas.height = innerHeight;

let reindeer, trees, speed, spawnRate;
let score = 0;
let running = false;
let move = 0;

/* Schwierigkeit */
const diff = document.getElementById("difficulty");
const label = document.getElementById("diffLabel");

diff.oninput = () => {
  label.textContent =
    diff.value == 1 ? "ğŸŸ¢ Leicht" :
    diff.value == 2 ? "ğŸŸ¡ Mittel" :
                      "ğŸ”´ Schwer";
};

/* Steuerung */
addEventListener("keydown", e => {
  if (e.key === "ArrowLeft") move = -1;
  if (e.key === "ArrowRight") move = 1;
});
addEventListener("keyup", () => move = 0);

canvas.addEventListener("touchmove", e => {
  reindeer.x = e.touches[0].clientX;
});

/* Spielstart */
function startGame() {
  document.getElementById("startScreen").style.display = "none";
  document.querySelector(".hud").style.display = "block";
  startMusic();

  reindeer = { x: canvas.width/2, y: canvas.height-120, size: 50 };
  trees = [];
  score = 0;

  if (diff.value == 1) {
    speed = 3;
    spawnRate = 0.015;
  } else if (diff.value == 2) {
    speed = 4;
    spawnRate = 0.025;
  } else {
    speed = 5.5;
    spawnRate = 0.04;
  }

  running = true;
  update();
}

/* Baum */
function spawnTree() {
  trees.push({
    x: Math.random() * (canvas.width - 60) + 30,
    y: -80,
    size: 60
  });
}

function update() {
  if (!running) return;

  ctx.clearRect(0,0,canvas.width,canvas.height);

  reindeer.x += move * 8;
  reindeer.x = Math.max(30, Math.min(canvas.width - 30, reindeer.x));

  trees.forEach(t => t.y += speed);

  trees.forEach(t => {
    if (Math.abs(reindeer.x - t.x) < 40 &&
        Math.abs(reindeer.y - t.y) < 40) {
      endGame();
    }
  });

  trees = trees.filter(t => {
    if (t.y > canvas.height + 50) {
      score++;
      document.getElementById("score").textContent = score;
      return false;
    }
    return true;
  });

  ctx.font = "50px serif";
  ctx.textAlign = "center";
  ctx.fillText("ğŸ¦Œ", reindeer.x, reindeer.y);

  trees.forEach(t => {
    ctx.font = t.size + "px serif";
    ctx.fillText("ğŸ„", t.x, t.y);
  });

  if (Math.random() < spawnRate) spawnTree();

  requestAnimationFrame(update);
}

function endGame() {
  running = false;
  document.getElementById("finalScore").textContent = score;
  document.getElementById("gameOver").style.display = "flex";
}
</script>

<!-- ğŸµ Hintergrundmusik -->
<iframe id="music"
  style="display:none"
  src="https://www.youtube.com/embed/IRfb8roh9KA?enablejsapi=1&controls=0&mute=0&loop=1&playlist=IRfb8roh9KA"
  allow="autoplay">
</iframe>

<script>
let musicStarted=false;
function startMusic(){
  if(musicStarted) return;
  music.contentWindow.postMessage(
    '{"event":"command","func":"playVideo","args":""}',"*"
  );
  musicStarted=true;
}
</script>

</body>
</html>

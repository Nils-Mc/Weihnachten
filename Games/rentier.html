<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ðŸ¦Œ Rentier-Rennen</title>

<style>
html, body {
  margin: 0;
  padding: 0;
  height: 100%;
  overflow: hidden;
  font-family: system-ui, -apple-system, sans-serif;
  background: radial-gradient(circle at top, #1b4d3e, #061a14);
  color: white;
}

/* Glass HUD */
.hud {
  position: fixed;
  top: 20px;
  left: 50%;
  transform: translateX(-50%);
  padding: 0.8rem 1.6rem;
  border-radius: 30px;
  background: rgba(255,255,255,0.15);
  backdrop-filter: blur(10px);
  box-shadow: 0 0 40px rgba(0,0,0,0.4);
  z-index: 10;
  font-size: 1.2rem;
}

/* Game */
canvas {
  position: fixed;
  inset: 0;
}

/* Schnee */
.snow {
  position: fixed;
  inset: 0;
  pointer-events: none;
  background-image:
    radial-gradient(white 1px, transparent 1px),
    radial-gradient(white 1px, transparent 1px);
  background-size: 40px 40px, 80px 80px;
  animation: snow 30s linear infinite;
  z-index: 2;
}

@keyframes snow {
  from { background-position: 0 0, 0 0; }
  to   { background-position: 0 2000px, 0 3000px; }
}

/* Game Over */
#gameOver {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.6);
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 20;
}

#gameOver div {
  background: rgba(255,255,255,0.18);
  backdrop-filter: blur(12px);
  padding: 2rem 3rem;
  border-radius: 30px;
  text-align: center;
}

#gameOver button {
  margin-top: 1rem;
  padding: 0.7rem 1.5rem;
  border-radius: 20px;
  border: none;
  font-size: 1rem;
  cursor: pointer;
}
</style>
</head>

<body>

<div class="hud">ðŸŽ„ Punkte: <span id="score">0</span></div>
<div class="snow"></div>

<canvas id="game"></canvas>

<div id="gameOver">
  <div>
    <h2>ðŸŽ… Oh nein!</h2>
    <p>Dein Score: <span id="finalScore"></span></p>
    <button onclick="restart()">Nochmal ðŸŽ„</button>
  </div>
</div>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
canvas.width = innerWidth;
canvas.height = innerHeight;

let reindeer = { x: canvas.width / 2, y: canvas.height - 120, size: 50 };
let trees = [];
let speed = 4;
let score = 0;
let running = true;
let move = 0;

function spawnTree() {
  trees.push({
    x: Math.random() * (canvas.width - 60) + 30,
    y: -80,
    size: 60
  });
}

document.addEventListener("keydown", e => {
  if (e.key === "ArrowLeft") move = -1;
  if (e.key === "ArrowRight") move = 1;
});
document.addEventListener("keyup", () => move = 0);

canvas.addEventListener("touchmove", e => {
  reindeer.x = e.touches[0].clientX;
});

function drawReindeer() {
  ctx.font = reindeer.size + "px serif";
  ctx.textAlign = "center";
  ctx.fillText("ðŸ¦Œ", reindeer.x, reindeer.y);
}

function drawTrees() {
  trees.forEach(t => {
    ctx.font = t.size + "px serif";
    ctx.textAlign = "center";
    ctx.fillText("ðŸŽ„", t.x, t.y);
  });
}

function update() {
  if (!running) return;

  ctx.clearRect(0,0,canvas.width,canvas.height);

  reindeer.x += move * 8;
  reindeer.x = Math.max(30, Math.min(canvas.width - 30, reindeer.x));

  trees.forEach(t => t.y += speed);

  trees.forEach(t => {
    const dx = reindeer.x - t.x;
    const dy = reindeer.y - t.y;
    if (Math.abs(dx) < 40 && Math.abs(dy) < 40) {
      endGame();
    }
  });

  trees = trees.filter(t => {
    if (t.y > canvas.height + 50) {
      score++;
      document.getElementById("score").textContent = score;
      return false;
    }
    return true;
  });

  drawReindeer();
  drawTrees();

  if (Math.random() < 0.02) spawnTree();

  requestAnimationFrame(update);
}

function endGame() {
  running = false;
  document.getElementById("finalScore").textContent = score;
  document.getElementById("gameOver").style.display = "flex";
}

function restart() {
  trees = [];
  score = 0;
  running = true;
  document.getElementById("score").textContent = 0;
  document.getElementById("gameOver").style.display = "none";
  update();
}

update();
</script>

</body>

<!-- Unsichtbarer Musik-Player -->
<iframe id="music"
  style="display:none"
  src="https://www.youtube.com/embed/IRfb8roh9KA?enablejsapi=1&controls=0&mute=0&loop=1&playlist=IRfb8roh9KA"
  allow="autoplay">
</iframe>

<script>
let musicStarted = false;
function startMusic(){
  if(musicStarted) return;
  document.getElementById("music").contentWindow.postMessage(
    '{"event":"command","func":"playVideo","args":""}',"*"
  );
  musicStarted = true;
}
addEventListener("click", startMusic, { once:true });
addEventListener("touchstart", startMusic, { once:true });
</script>

</html>

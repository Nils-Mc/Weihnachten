<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>üéÅ Geschenkestapel</title>

<style>
html,body{
  margin:0;
  padding:0;
  height:100%;
  overflow:hidden;
  font-family:system-ui,-apple-system,sans-serif;
  background:radial-gradient(circle at top,#1b4d3e,#061a14);
  color:white;
}
canvas{display:block}

/* HUD */
.hud{
  position:fixed;
  top:20px;
  left:50%;
  transform:translateX(-50%);
  padding:.8rem 1.6rem;
  border-radius:30px;
  background:rgba(255,255,255,.15);
  backdrop-filter:blur(10px);
  z-index:10;
}

/* Schnee */
.snow{
  position:fixed;
  inset:0;
  pointer-events:none;
  background-image:
    radial-gradient(white 1px,transparent 1px),
    radial-gradient(white 1px,transparent 1px);
  background-size:40px 40px,80px 80px;
  animation:snow 30s linear infinite;
}
@keyframes snow{
  from{background-position:0 0,0 0}
  to{background-position:0 2000px,0 3000px}
}

/* Game Over */
#over{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.6);
  display:none;
  align-items:center;
  justify-content:center;
  z-index:20;
}
#over div{
  background:rgba(255,255,255,.18);
  backdrop-filter:blur(12px);
  padding:2rem 3rem;
  border-radius:30px;
  text-align:center;
}
</style>
</head>

<body>

<div class="hud">üéÅ Stapel: <span id="score">0</span></div>
<div class="snow"></div>
<canvas id="game"></canvas>

<div id="over">
  <div>
    <h2>üéÑ Game Over</h2>
    <p>Score: <span id="final"></span></p>
    <button onclick="restart()">Nochmal</button>
  </div>
</div>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
canvas.width = innerWidth;
canvas.height = innerHeight;

let blocks = [];
let current;
let dir = 1;
let speed = 2.5;
let score = 0;
let running = true;
let camY = 0;

/* Basis */
blocks.push({
  x: canvas.width/2 - 150,
  y: canvas.height - 80,
  w: 300,
  h: 30
});

function newBlock(){
  const last = blocks[blocks.length-1];
  current = {
    x: 0,
    y: last.y - 40,
    w: last.w,
    h: 30
  };
  dir = 1;
}

function drop(){
  if(!running) return;

  const last = blocks[blocks.length-1];

  const left = Math.max(current.x, last.x);
  const right = Math.min(current.x + current.w, last.x + last.w);
  const overlap = right - left;

  if(overlap <= 8){
    gameOver();
    return;
  }

  current.x = left;
  current.w = overlap;

  blocks.push({...current});
  score++;
  document.getElementById("score").textContent = score;

  speed += 0.15;
  camY += 40;
  newBlock();
}

addEventListener("click", drop);
addEventListener("touchstart", drop);

function drawBlock(b){
  ctx.fillStyle = "#c0392b";
  ctx.fillRect(b.x, b.y + camY, b.w, b.h);
  ctx.font = "20px serif";
  ctx.textAlign = "center";
  ctx.fillText("üéÅ", b.x + b.w/2, b.y + camY + 22);
}

function loop(){
  if(!running) return;
  ctx.clearRect(0,0,canvas.width,canvas.height);

  current.x += speed * dir;
  if(current.x <= 0 || current.x + current.w >= canvas.width){
    dir *= -1;
  }

  blocks.forEach(drawBlock);
  drawBlock(current);

  requestAnimationFrame(loop);
}

function gameOver(){
  running = false;
  document.getElementById("final").textContent = score;
  document.getElementById("over").style.display = "flex";
}

function restart(){
  blocks = [];
  blocks.push({
    x: canvas.width/2 - 150,
    y: canvas.height - 80,
    w: 300,
    h: 30
  });
  score = 0;
  speed = 2.5;
  camY = 0;
  running = true;
  document.getElementById("score").textContent = 0;
  document.getElementById("over").style.display = "none";
  newBlock();
  loop();
}

newBlock();
loop();
</script>

<!-- üéµ Hintergrundmusik -->
<iframe id="music"
  style="display:none"
  src="https://www.youtube.com/embed/IRfb8roh9KA?enablejsapi=1&controls=0&mute=0&loop=1&playlist=IRfb8roh9KA"
  allow="autoplay">
</iframe>

<script>
let started=false;
function startMusic(){
  if(started) return;
  music.contentWindow.postMessage(
    '{"event":"command","func":"playVideo","args":""}',"*"
  );
  started=true;
}
addEventListener("click",startMusic,{once:true});
addEventListener("touchstart",startMusic,{once:true});
</script>

</body>
</html>
